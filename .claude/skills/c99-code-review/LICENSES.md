# Licensing Requirements for HBF

## Approved Licenses

HBF is MIT-licensed and can only include dependencies with compatible licenses.

### ✅ Permitted Licenses

1. **MIT License**
   - Very permissive
   - Allows commercial use
   - Requires copyright notice

2. **BSD License** (2-clause and 3-clause)
   - Similar to MIT
   - Allows commercial use
   - Requires copyright notice
   - 3-clause includes non-endorsement clause

3. **Apache License 2.0**
   - Permissive with patent grant
   - Allows commercial use
   - Requires copyright notice and license copy

4. **Public Domain** / **CC0**
   - No restrictions
   - Examples: SQLite (Public Domain)

5. **ISC License**
   - Functionally equivalent to MIT
   - Simpler wording

### ❌ Prohibited Licenses

1. **GPL (v2, v3)**
   - Copyleft - requires derivative works to be GPL
   - Incompatible with MIT for combined works

2. **LGPL**
   - Less restrictive than GPL but still problematic for static linking
   - HBF uses static linking exclusively

3. **AGPL**
   - Even more restrictive than GPL
   - Requires source distribution for network use

4. **Creative Commons with ShareAlike (CC-BY-SA)**
   - Copyleft for content/documentation
   - Can be used for docs, NOT for code

5. **Proprietary / Closed Source**
   - No license or all rights reserved
   - Cannot be included

## Current Dependencies

### Verified Approved Dependencies

| Dependency | License | Notes |
|------------|---------|-------|
| SQLite | Public Domain | No restrictions |
| CivetWeb | MIT | Web server |
| QuickJS-NG | MIT | JavaScript engine |
| musl libc | MIT | C standard library |

## Adding New Dependencies

Before adding any third-party code or library:

### 1. Identify the License

Check for license files:
- `LICENSE`, `LICENSE.txt`, `LICENSE.md`
- `COPYING`, `COPYRIGHT`
- Headers in source files
- Package metadata (package.json, Cargo.toml, etc.)

### 2. Verify Compatibility

**Questions to ask:**
- Is the license on the approved list?
- Does it allow commercial use?
- Does it allow redistribution?
- Does it require copyleft (derivative works must use same license)?
- Does it have patent grant issues?

### 3. Document the Dependency

Add to CLAUDE.md:
```markdown
### Licensing Constraints
**No GPL dependencies**. Only MIT, BSD, Apache-2.0, or Public Domain:
- SQLite (Public Domain)
- CivetWeb (MIT)
- QuickJS (MIT)
- NewLibrary (MIT) <-- Add here
```

### 4. Add SPDX Header

All new source files must include SPDX license identifier:

```c
// SPDX-License-Identifier: MIT
```

For files from other projects, preserve original copyright:

```c
// SPDX-License-Identifier: MIT
// Copyright (c) 2024 Original Author
// Modified for HBF
```

## Special Cases

### Dual-Licensed Code

Some projects offer multiple licenses (e.g., "MIT OR Apache-2.0"):
- ✅ Choose the MIT option
- Document which license you're using

### No License Found

If no license file exists:
- ❌ Assume "all rights reserved" (proprietary)
- DO NOT USE without explicit permission
- Contact author for clarification

### Code Snippets from Stack Overflow

- Stack Overflow content is CC-BY-SA 4.0
- Small snippets (< 10 lines) generally acceptable as fair use
- Larger snippets require rewriting
- Always credit source in comments

```c
/* Adapted from Stack Overflow answer by UserName (CC-BY-SA 4.0)
 * https://stackoverflow.com/a/12345678
 * Rewritten to avoid license conflict
 */
```

### Generated Code

Code generated by tools (e.g., protocol buffers, parser generators):
- Check generator's license
- Check if generated code has different license
- Commonly: BSD or Apache licenses

## License Checking Tools

### Manual Check

```bash
# Find license files
find third_party/ -iname "LICENSE*" -o -iname "COPYING*"

# Check for SPDX headers
grep -r "SPDX-License-Identifier" .
```

### Automated Tools

For dependency scanning (future):
```bash
# Example with cargo-license (Rust)
cargo install cargo-license
cargo license

# Example with license-checker (Node.js)
npm install -g license-checker
license-checker --summary
```

## Red Flags

Watch for these warning signs:

1. **No license file** - Assume proprietary, do not use
2. **"For non-commercial use only"** - Prohibited
3. **"Educational purposes only"** - Prohibited for production
4. **"Evaluation license"** - Temporary, not for production
5. **"Dual license: GPL or Commercial"** - Must purchase commercial license

## Example: Evaluating a New Library

**Scenario:** Want to add a new JSON parser library.

**Steps:**

1. **Find the license:**
   ```
   https://github.com/library/json-parser/blob/main/LICENSE
   → Contains "MIT License"
   ```

2. **Verify it's actually MIT:**
   - Read full text
   - Check for additional restrictions
   - Confirm it matches OSI-approved MIT text

3. **Check dependencies:**
   ```
   README.md lists dependencies:
   - libc (MIT via musl)
   - No other dependencies
   ```

4. **Add to project:**
   - Add to `third_party/json-parser/`
   - Preserve LICENSE file
   - Update CLAUDE.md
   - Add SPDX headers to any new glue code

5. **Document:**
   ```c
   // In hbf/json/parser.c
   // SPDX-License-Identifier: MIT
   // Wrapper for json-parser library (MIT)
   ```

## When in Doubt

If you're unsure about a license:

1. **DO NOT** include the code
2. Ask for review from project maintainer
3. Consider alternatives with clear licensing
4. Rewrite functionality if necessary

**Remember:** License violations can require removing features, rewriting code, or changing the entire project license. Always verify before adding dependencies.
